<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

<!-- Navbar -->
<nav class="navbar navbar-expand-lg fixed-top g-0 p-3" style="background-color: #9381ff;">
  <div class="container-fluid" style="background-color: #9381ff;">
    <a class="navbar-brand" href="#">
      <img src="../../../assets/images/logo.png" height="40" alt="Logo">
      <span class="text-white ps-4 fs-3 fw-bold">AM Exam Portal</span>
    </a>
    <div class="d-flex align-items-center" id="user">
      <i class="fas fa-user-circle fa-4x me-2"></i>
      <h5 class="ms-2">{{ name }}</h5>
    </div>
  </div>
</nav>

<div class="container-fluid">
  <main class="col-md-10 ms-sm-auto col-lg-12 px-md-4 mt-5 ps-5 pe-5 pb-5">
    <div
      class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    </div>
    <div class="row mt-5">
      <div class="col-12">
        <h3>Welcome {{ name }}</h3>

        <button class="btn btn-primary mb-3" (click)="downloadCSV()">Download all test history reports</button>

        <p>Following are the previous test scores:</p>
        <!-- <table class="table table-striped">
          <thead>
            <tr>
              <th>Last Update</th>
              <th>Score</th>
              <th>Total Questions</th>
              <th>Time Taken</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let result of testHistory">
              <td>{{ result.date | timeAgo }}</td>
              <td>{{ result.score }}</td>
              <td>{{ result.totalQuestions }}</td>
              <td>{{ result.timeTaken | formatTime }}</td>
            </tr>
          </tbody>
        </table>
      </div> -->

      <div class="card-body">
        <table class="table table-hover table-bordered table-striped">
          <thead>
            <tr class="text-center">
              <th>Subject Name</th>
              <th>Total Questions</th>
              <th>Attempted Questions</th>
              <th>Unattempted Questions</th>
              <th>Correct Questions</th>
              <th>Incorrect Questions</th>
              <th>Percentage Obtained</th>
              <th>Test Repsonse sheet</th>
            </tr>
          </thead>
          <tbody>
            <tr class="text-center" *ngFor="let result of paginatedResults">
              <ng-container>
                <td>{{ result.subjectName }}</td>
                <td>{{ result.totalQuestions }}</td>
                <td>{{ result.attemptedQuestions }}</td>
                <td>{{ result.unAttemptedQuestions }}</td>
                <td>{{ result.correctQuestions }}</td>
                <td>{{ result.inCorrectQuestions }}</td>
                <td>{{ result.percentageObtained }}%</td>
                <!-- <td>
                  <button class="btn btn-sm btn-info" 
                  (click)="downloadTestReportCSV(result.testId)"
                  >
                    <i class="fas fa-download"></i>
                  </button>
                </td> -->
              </ng-container>
            </tr>
          </tbody>
        </table>

        <!-- Pagination Controls -->
        <nav aria-label="Page navigation">
          <ul class="pagination justify-content-center">
            <li class="page-item" [class.disabled]="currentPage === 1">
              <button class="page-link" (click)="changePage(currentPage - 1)">Previous</button>
            </li>
            <li class="page-item" *ngFor="let page of pagesArray">
              <button class="page-link" (click)="changePage(page)">{{ page }}</button>
            </li>
            <li class="page-item" [class.disabled]="currentPage === totalPages">
              <button class="page-link" (click)="changePage(currentPage + 1)">Next</button>
            </li>
          </ul>
        </nav>
      </div>

      <div class="d-flex justify-content-center mb-5">
        <button routerLink="/home" class="btn btn-goHome rounded-pill ps-5 pe-5 text-light">Go to Home</button>
      </div>
    </div>
</div>

<app-logged-in-footer></app-logged-in-footer>